<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ilha das Emoções: Jornada Terapêutica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            color: #374151; /* Texto geral mais escuro (gray-700) */
            
            background-image: url('https://cdn.jsdelivr.net/gh/gabriel20402/Jogos-terapeuticos@main/Sunny.jpg');
            background-size: cover; 
            background-position: center center; 
            background-repeat: no-repeat; 
            background-attachment: fixed; 
        }

        .map-container {
            background-color: #fff8e1;
            background-size: cover;
            background-position: center;
            min-height: 400px;
            position: relative;
            padding: 2rem;
        }
        .island-card {
            transition: all 0.3s ease;
        }
        .island-card:hover {
            transform: scale(1.05) translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .back-button {
            transition: background-color 0.2s;
        }
        .back-button:hover {
            background-color: #e53e3e;
        }

        #vertical-credits {
            position: fixed;
            bottom: 110px;  
            right: 18px;    
            writing-mode: vertical-rl;  
            transform: rotate(180deg);  
            z-index: 40;
            color: rgba(255, 255, 255, 0.6); 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7); 
            font-size: 0.7rem;
        }
        #vertical-credits a {
            font-weight: bold;
            color: rgba(255, 255, 255, 0.8);
            transition: color 0.2s ease;
        }
        #vertical-credits a:hover {
            color: white;
        }

        /* --- ESTILO CORRIGIDO PARA O CRP --- */
        #crp-vertical {
            position: fixed;
            bottom: 110px; /* Mesma base do outro texto */
            right: 45px;    /* Posicionado à ESQUERDA do outro texto */
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            z-index: 40;
            color: rgba(255, 255, 255, 0.6);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
            font-size: 0.7rem;
        }

        @media (max-width: 768px) {
            #vertical-credits, #crp-vertical {
                display: none;
            }
        }
    </style>
<script src="seguranca.js" defer></script>
</head>
<body>

    <a href="https://www.instagram.com/gabrielopsicologo" target="_blank" class="fixed top-6 right-6 z-50 transition-transform duration-300 hover:scale-110">
        <img src="https://cdn.jsdelivr.net/gh/gabriel20402/Jogos-terapeuticos@main/Logo_branca.png" alt="Logo Gabriel Psicólogo" class="h-28 drop-shadow-lg">
    </a>

    <a href="https://wa.me/message/WV34TWMSKTEEL1" target="_blank" title="Precisa de Ajuda?" class="fixed bottom-6 right-6 bg-[#128C7E] text-white p-4 rounded-full shadow-lg hover:bg-[#075E54] transition z-50">
        <i data-lucide="message-circle" class="w-6 h-6"></i>
    </a>

    <div id="vertical-credits">
        <p>
            Recurso terapêutico por 
            <a href="https://www.instagram.com/gabrielopsicologo" target="_blank">
                @gabrielopsicologo
            </a>
        </p>
    </div>
    <div id="crp-vertical">
        CRP 06/215890
    </div>

    <div id="app" class="min-h-screen flex flex-col items-center">
        <header class="w-full bg-red-600 text-white shadow-lg p-4 flex justify-between items-center rounded-b-lg">
            <h1 class="text-2xl font-black tracking-wider flex items-center">
                <img src="https://cdn.jsdelivr.net/gh/gabriel20402/Jogos-terapeuticos@main/Emblema_One_%20piece.png" alt="Emblema One Piece" class="h-8 w-auto mr-2">
                Ilha das Emoções
            </h1>
            <div id="auth-info" class="text-sm opacity-90 text-right">
                </div>
        </header>

        <main id="content" class="w-full max-w-4xl p-4 sm:p-6 flex-grow">
            <div id="loading" class="text-center p-8 text-gray-700"> 
                <i data-lucide="loader-circle" class="w-8 h-8 mx-auto animate-spin"></i>
                <p class="mt-2">Ajustando a Bússola e preparando a viagem...</p>
            </div>
        </main>
    </div>

    <div id="instructionsModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden flex items-center justify-center p-4" onclick="window.hideInstructionsModal()">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-lg w-full transform transition-all" onclick="event.stopPropagation()">
            <div class="flex items-center border-b pb-3 mb-4">
                 <i data-lucide="alert-triangle" class="w-6 h-6 text-yellow-500 mr-3"></i>
                 <h3 class="text-xl font-bold text-gray-800">Instruções para Terapeutas</h3> 
            </div>
            <ul class="space-y-3 text-gray-700 list-disc list-inside"> 
                <li>
                    <strong>Salvamento de Dados:</strong> Esta ferramenta salva o histórico <strong>apenas neste navegador</strong> (Modo Local). Os dados não são enviados para um servidor. É sua responsabilidade transferir as informações relevantes para os registros oficiais do paciente após a sessão.
                </li>
                <li>
                    <strong>Ferramenta de Apoio:</strong> Utilize esta jornada como um guia e um recurso lúdico para facilitar a exploração terapêutica, e não como um roteiro inflexível.
                </li>
                <li>
                    <strong>Aplicação Cuidadosa:</strong> Sempre adapte as perguntas, a linguagem e a abordagem ao contexto e às necessidades individuais de cada paciente.
                </li>
            </ul>
            <div class="mt-6 text-right">
                <button onclick="window.hideInstructionsModal()" class="bg-red-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-red-700 transition duration-200 shadow-md">
                    Entendi
                </button>
            </div>
        </div>
    </div>
    
    <div id="image-export-container" style="position: absolute; left: -9999px; top: -9999px;"></div>


    <script type="module">
        let selectedPatientName = localStorage.getItem('lastPatientName') || null; 
        let localSessions = [];

        let currentPage = selectedPatientName ? 'map' : 'login';
        let currentEmotion = null;

        const EMOTIONS = {
            RAIVA: {
                name: "Raiva (Ilha do Vulcão)", color: "bg-red-700", textColor: "text-red-700", icon: "flame",
                questions: [{ id: "s-raiva", q: "O que aconteceu? Qual foi o gatilho que acendeu sua chama interior?" }, { id: "t-raiva", q: "Que pensamento (ou 'tesouro') passou pela sua cabeça nesse momento?" }, { id: "b-raiva", q: "Como você reagiu ou agiu? Descreva seu comportamento." }, { id: "a-raiva", q: "Qual habilidade diferente você poderia usar na próxima vez?" }]
            },
            ALEGRIA: {
                name: "Alegria (Enseada Radiante)", color: "bg-yellow-500", textColor: "text-yellow-500", icon: "sun",
                questions: [{ id: "s-alegria", q: "O que aconteceu? Qual foi o motivo que fez o sol brilhar para você?" }, { id: "t-alegria", q: "Qual era o 'mapa' do tesouro (pensamento) que você estava seguindo?" }, { id: "b-alegria", q: "Como você expressou essa alegria e o que isso te fez querer fazer?" }, { id: "a-alegria", q: "Como você pode 'reabastecer seu navio' com essa alegria? O que aprendeu que pode repetir?" }]
            },
            MEDO: {
                name: "Medo (Pântano Sombrio)", color: "bg-indigo-700", textColor: "text-indigo-700", icon: "eye-off",
                questions: [{ id: "s-medo", q: "O que te fez sentir que uma 'tempestade' (ameaça) se aproximava? Qual foi o gatilho?" }, { id: "t-medo", q: "Qual foi a previsão (pensamento) que você fez sobre o que poderia acontecer?" }, { id: "b-medo", q: "Qual foi sua rota de fuga ou defesa? O que você evitou ou fez por causa do medo?" }, { id: "a-medo", q: "Qual a chance real desta 'tempestade' (a ameaça) te alcançar? Que evidências te acalmam?" }]
            },
            TRISTEZA: {
                name: "Tristeza (Gruta Solitária)", color: "bg-blue-700", textColor: "text-blue-700", icon: "cloud-drizzle",
                questions: [{ id: "s-tristeza", q: "Qual foi a 'batalha perdida' que te fez sentir assim? O que aconteceu?" }, { id: "t-tristeza", q: "Qual foi a lembrança (pensamento) que veio à sua mente?" }, { id: "b-tristeza", q: "O que você fez (ou deixou de fazer) enquanto estava triste? Descreva seu comportamento." }, { id: "a-tristeza", q: "Que pequeno 'tesouro' (gesto de autocuidado) você pode encontrar para si mesmo agora?" }]
            }
        };
        
        setTimeout(renderApp, 100); 

        async function saveSession() {
            if (!selectedPatientName) {
                displayMessage("Selecione um paciente primeiro!", 'bg-red-500'); return;
            }
            const form = document.getElementById('emotion-form');
            const answers = {};
            let isComplete = true;

            EMOTIONS[currentEmotion].questions.forEach(q => {
                const input = form.querySelector(`#${q.id}`);
                const value = input ? input.value.trim() : '';
                answers[q.id] = value;
                if (!value) isComplete = false;
            });

            if (!isComplete) {
                displayMessage("Responda todas as perguntas!", 'bg-yellow-500'); return;
            }
            
            const newSession = {
                patientName: selectedPatientName, emotion: currentEmotion, emotionName: EMOTIONS[currentEmotion].name, answers: answers, timestamp: new Date().toISOString()
            };

            const currentSavedSessions = JSON.parse(localStorage.getItem(`localSessions_${selectedPatientName}`)) || [];
            currentSavedSessions.push(newSession);
            localStorage.setItem(`localSessions_${selectedPatientName}`, JSON.stringify(currentSavedSessions));
            localSessions = currentSavedSessions;
            displayMessage("Diário de Bordo atualizado!", 'bg-blue-500');
            renderMap();
        }

        function loadAndDisplaySessions() {
            renderHistory(localSessions);
        }

        function displayMessage(text, bgColor) {
            const messageBox = document.createElement('div');
            messageBox.className = `${bgColor} text-white p-3 rounded-lg shadow-xl mb-4 text-center fixed top-4 left-1/2 transform -translate-x-1/2 z-50 transition-opacity duration-300`;
            messageBox.textContent = text;
            document.body.appendChild(messageBox);

            setTimeout(() => {
                messageBox.style.opacity = '0';
                messageBox.addEventListener('transitionend', () => messageBox.remove());
            }, 3000);
        }

        function renderApp() {
            const loadingElement = document.getElementById('loading');
            if (loadingElement) loadingElement.remove(); 
            updateAuthInfo();
            if (selectedPatientName) {
                localSessions = JSON.parse(localStorage.getItem(`localSessions_${selectedPatientName}`)) || [];
            }
            if (!selectedPatientName || currentPage === 'login') {
                renderPatientSelector();
            } else if (currentPage === 'map') {
                renderMap();
            } else if (currentPage === 'island' && currentEmotion) {
                renderIsland(currentEmotion);
            }
            lucide.createIcons();
        }
        
        function updateAuthInfo() {
            const authInfoDiv = document.getElementById('auth-info');
            if (selectedPatientName) {
                let statusText = selectedPatientName + ' (Modo Local)';
                authInfoDiv.innerHTML = `<p class="font-bold">Navegador:</p><span class="text-yellow-300">${statusText}</span>`;
            } else {
                authInfoDiv.innerHTML = `<p class="font-bold">Modo:</p><span class="text-yellow-300">Seleção de Paciente</span>`;
            }
        }

        function renderPatientSelector() {
            currentPage = 'login';
            selectedPatientName = null;
            localSessions = []; 
            localStorage.removeItem('lastPatientName'); 
            updateAuthInfo();
            const contentDiv = document.getElementById('content');
            const instructionsButton = `
                <div class="text-center mb-6">
                    <button onclick="window.showInstructionsModal()" class="text-sm text-blue-600 hover:underline font-semibold flex items-center justify-center mx-auto p-2 rounded-md hover:bg-blue-50 transition">
                        <i data-lucide="alert-circle" class="w-4 h-4 mr-1"></i>
                        Avisos e Instruções Importantes
                    </button>
                </div>
            `;
            contentDiv.innerHTML = `
                <div class="p-8 bg-white rounded-xl shadow-2xl border-t-8 border-red-600 max-w-md mx-auto mt-12 text-center">
                    <i data-lucide="compass" class="w-12 h-12 text-red-600 mx-auto mb-4"></i>
                    <h2 class="text-3xl font-extrabold text-gray-900 mb-2">Início da Jornada</h2>
                    <p class="text-gray-700 mb-4">Insira o nome do navegante para iniciar a sessão.</p> 
                    ${instructionsButton}
                    <form id="patient-form" onsubmit="event.preventDefault(); window.setPatient()">
                        <div class="mb-4">
                            <input type="text" id="patientNameInput" placeholder="Nome do Navegante" 
                                   class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-red-500 focus:ring focus:ring-red-200 text-gray-800" required> 
                        </div>
                        <button type="submit" class="w-full bg-red-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg hover:bg-red-700 transition duration-200 flex items-center justify-center">
                            <i data-lucide="log-in" class="w-5 h-5 mr-2"></i>
                            Iniciar Sessão
                        </button>
                    </form>
                </div>`;
            lucide.createIcons();
        }

        window.setPatient = function() {
            const input = document.getElementById('patientNameInput');
            const name = input.value.trim();
            if (name) {
                selectedPatientName = name;
                localSessions = JSON.parse(localStorage.getItem(`localSessions_${selectedPatientName}`)) || [];
                localStorage.setItem('lastPatientName', name); 
                updateAuthInfo();
                renderMap();
            } else {
                displayMessage("Por favor, insira o nome do navegante.", 'bg-yellow-500');
            }
        }

        function renderMap() {
            currentPage = 'map';
            currentEmotion = null;
            const contentDiv = document.getElementById('content');

            const islandButtonsHtml = Object.entries(EMOTIONS).map(([key, emotion]) => {
                const nameParts = emotion.name.split('(');
                const emotionText = nameParts[0].trim();
                const islandText = nameParts[1] ? nameParts[1].replace(')', '').trim() : emotionText;

                return `
                    <button data-emotion="${key}" class="island-card ${emotion.color} text-white p-4 rounded-xl shadow-lg flex flex-col items-center justify-center text-center font-bold" onclick="window.selectEmotion('${key}')">
                        <i data-lucide="${emotion.icon}" class="w-8 h-8 sm:w-10 sm:h-10 mb-2"></i>
                        <span class="text-lg sm:text-xl">${islandText}</span> 
                        <span class="text-sm opacity-80 mt-1">(${emotionText})</span> 
                    </button>
                `;
            }).join('');

            contentDiv.innerHTML = `
                <div class="map-container rounded-xl shadow-2xl p-4 sm:p-8 bg-amber-100 border-4 border-amber-900">
                    <button onclick="window.renderPatientSelector()" class="back-button bg-red-600 text-white px-4 py-2 rounded-lg mb-4 flex items-center shadow absolute top-4 right-4 text-sm z-10">
                        <i data-lucide="users" class="w-4 h-4 mr-1"></i>
                        Mudar Navegante
                    </button>
                    <h2 class="text-3xl font-extrabold text-amber-900 mb-6 text-center pt-8">
                        <i data-lucide="map" class="w-8 h-8 inline-block mr-2"></i>
                        O Grande Oceano: Para onde vamos hoje?
                    </h2>
                    <p class="text-amber-800 text-center mb-8">
                        Navegante em Sessão: <span class="font-bold text-red-600">${selectedPatientName}</span>.
                        Escolha um destino para explorar.
                    </p>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        ${islandButtonsHtml}
                    </div>
                </div>
                <div class="mt-8 p-4 bg-white rounded-xl shadow-lg">
                    <div class="flex justify-between items-center border-b pb-2 mb-4">
                        <h3 class="text-xl font-bold text-gray-800"> 
                            Diário de Bordo (Navegante: ${selectedPatientName})
                        </h3>
                        <button onclick="window.clearAllSessions()" class="text-sm bg-red-100 text-red-700 hover:bg-red-200 font-semibold py-1 px-3 rounded-lg flex items-center transition">
                            <i data-lucide="trash-2" class="w-4 h-4 mr-1"></i>
                            Limpar Histórico
                        </button>
                    </div>
                    <ul id="history-list" class="space-y-3 text-sm text-gray-700"></ul> 
                </div>`;
            lucide.createIcons();
            loadAndDisplaySessions();
        }

        function renderIsland(emotionKey) {
            currentPage = 'island';
            currentEmotion = emotionKey;
            const emotion = EMOTIONS[emotionKey];
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = `
                <div id="island-container" class="p-4 sm:p-8 bg-white rounded-xl shadow-2xl border-t-8 border-red-600">
                    <button onclick="window.renderMap()" class="back-button bg-gray-500 text-white px-4 py-2 rounded-lg mb-4 flex items-center shadow no-print">
                        <i data-lucide="arrow-left" class="w-5 h-5 mr-1"></i>
                        Voltar ao Mapa
                    </button>
                    <h2 class="text-3xl font-extrabold text-gray-900 mb-2 flex items-center ${emotion.textColor}"> 
                        <i data-lucide="${emotion.icon}" class="w-7 h-7 mr-2"></i>
                        ${emotion.name}
                    </h2>
                    <p class="text-gray-700 mb-6 border-b pb-4"> 
                        Navegante: <span class="font-bold text-red-600">${selectedPatientName}</span>. Vamos preencher seu Diário de Bordo.
                    </p>
                    <form id="emotion-form" onsubmit="event.preventDefault(); window.saveSession()">
                        ${emotion.questions.map(q => `
                            <div class="mb-6 p-4 border-l-4 border-red-600 bg-gray-50 rounded-lg">
                                <label for="${q.id}" class="block text-lg font-semibold text-gray-800 mb-2">${q.q}</label> 
                                <textarea id="${q.id}" rows="4" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-red-500 focus:ring focus:ring-red-200 resize-none text-gray-800" placeholder="Escreva aqui seu registro..."></textarea> 
                            </div>
                        `).join('')}
                         <button type="submit" class="w-full bg-red-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg hover:bg-red-700 transition duration-200 mt-6 flex items-center justify-center">
                            <i data-lucide="send" class="w-5 h-5 mr-2"></i>
                            Salvar Registro e Zarpar
                        </button>
                    </form>
                </div>`;
            lucide.createIcons();
        }

        function renderHistory(sessions) {
            const historyList = document.getElementById('history-list');
            if (!historyList) return;

            if (!sessions || sessions.length === 0) {
                historyList.innerHTML = `<li class="italic text-gray-500">Nenhuma viagem registrada ainda.</li>`;
                return;
            }

            sessions.sort((a, b) => (new Date(b.timestamp).getTime()) - (new Date(a.timestamp).getTime()));

            historyList.innerHTML = sessions.map((session, index) => {
                const date = new Date(session.timestamp).toLocaleString('pt-BR');
                const emotionName = session.emotionName.split('(')[0].trim();
                const sessionIcon = EMOTIONS[session.emotion]?.icon || 'anchor';
                const answersHtml = EMOTIONS[session.emotion]?.questions.map(q => `<p><strong>${q.q}</strong><br><span class="text-gray-600">${session.answers[q.id] || 'Sem resposta.'}</span></p>`).join('');
                return `
                    <li class="border-b last:border-b-0 py-3 flex items-start space-x-3 text-gray-700"> 
                        <i data-lucide="${sessionIcon}" class="w-5 h-5 text-red-600 flex-shrink-0 mt-1"></i>
                        <div class="flex-grow">
                            <p class="font-semibold">${emotionName} - <span class="font-normal text-gray-500">${date}</span></p> 
                            <div class="mt-2 flex items-center space-x-4">
                                <details>
                                    <summary class="cursor-pointer text-sm text-blue-600 hover:text-blue-800 font-semibold">Ver registro</summary>
                                    <div class="bg-gray-50 p-3 mt-2 rounded-md text-xs space-y-2 border text-gray-700">${answersHtml}</div> 
                                </details>
                                <button onclick="window.exportHistoryEntryAsImage(${index})" class="text-sm text-green-600 hover:text-green-800 font-semibold flex items-center">
                                    <i data-lucide="camera" class="w-4 h-4 mr-1"></i>Exportar
                                </button>
                            </div>
                        </div>
                    </li>`;
            }).join('');
            lucide.createIcons();
        }
        
        window.clearAllSessions = function() {
            if (localSessions.length === 0) {
                displayMessage('O histórico já está vazio.', 'bg-yellow-500');
                return;
            }
            if (confirm(`Tem certeza que deseja apagar TODOS os ${localSessions.length} registros de ${selectedPatientName}? Esta ação não pode ser desfeita.`)) {
                localStorage.removeItem(`localSessions_${selectedPatientName}`);
                localSessions = [];
                displayMessage('Histórico do navegante foi limpo.', 'bg-blue-500');
                renderMap();
            }
        }

        function generateSessionHtmlForExport(session) {
            const emotion = EMOTIONS[session.emotion];
            if (!emotion) return '';
            const answersHtml = emotion.questions.map(q => `
                <div class="mb-4 p-3 border-l-4 border-red-500 bg-gray-50 rounded-r-lg">
                    <h3 class="text-base font-semibold text-gray-800">${q.q}</h3> 
                    <p class="mt-1 text-gray-700">${session.answers[q.id] || 'Sem resposta.'}</p> 
                </div>
            `).join('');
            return `
                <div class="p-8 bg-white rounded-lg shadow-lg border-t-8 border-red-600" style="width: 800px;">
                    <h2 class="text-4xl font-extrabold mb-2 flex items-center ${emotion.textColor}">
                        <i data-lucide="${emotion.icon}" class="w-9 h-9 mr-3"></i>
                        ${emotion.name}
                    </h2>
                    <p class="text-lg text-gray-700 mb-6 border-b pb-4"> 
                        Navegante: <span class="font-bold text-red-600">${session.patientName}</span>
                    </p>
                    ${answersHtml}
                    <p class="text-right text-xs text-gray-500 mt-6"> 
                        Registro de ${new Date(session.timestamp).toLocaleString('pt-BR')}
                    </p>
                </div>
            `;
        }
        
        window.exportHistoryEntryAsImage = async function(sessionIndex) {
            const session = localSessions[sessionIndex];
            if (!session) return;
            displayMessage('Gerando imagem do registro...', 'bg-blue-500');
            const exportContainer = document.getElementById('image-export-container');
            exportContainer.innerHTML = generateSessionHtmlForExport(session);
            const iconsInContainer = exportContainer.querySelectorAll('[data-lucide]');
            if (iconsInContainer.length > 0) {
                 lucide.createIcons({ nodes: Array.from(iconsInContainer) });
                 await new Promise(resolve => setTimeout(resolve, 100));
            }
            const elementToCapture = exportContainer.querySelector('div');
            if (!elementToCapture) return;

            try {
                const canvas = await html2canvas(elementToCapture, { backgroundColor: '#ffffff', scale: 2 });
                const link = document.createElement('a');
                const safePatientName = session.patientName.replace(/[^a-z0-9]/gi, '_').toLowerCase();
                const emotionName = session.emotion.toLowerCase();
                link.download = `registro_${safePatientName}_${emotionName}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            } catch (error) {
                console.error('Erro ao exportar imagem:', error);
                displayMessage('Houve um erro ao gerar a imagem.', 'bg-red-500');
            } finally {
                exportContainer.innerHTML = '';
            }
        }

        window.showInstructionsModal = function() {
            document.getElementById('instructionsModal')?.classList.remove('hidden');
        }
        window.hideInstructionsModal = function() {
            document.getElementById('instructionsModal')?.classList.add('hidden');
        }

        window.renderMap = renderMap;
        window.selectEmotion = renderIsland;
        window.saveSession = saveSession;
        window.renderPatientSelector = renderPatientSelector; 
        window.setPatient = setPatient;

        window.onload = () => {
            lucide.createIcons();
        };
    </script>
    
    <script>
        // Desabilita o clique direito em TODA a página
        document.addEventListener('contextmenu', event => event.preventDefault());

        // Desabilita atalhos para abrir DevTools
        document.onkeydown = function(e) {
            // F12
            if (e.keyCode == 123) {
                return false;
            }
            // Ctrl+Shift+I
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                return false;
            }
            // Ctrl+Shift+J
            if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                return false;
            }
            // Ctrl+U
            if (e.ctrlKey && e.key === 'u') {
                return false;
            }
        };
    </script>

</body>
</html>