<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PsicoQuest - Roleta Reflexiva da Ansiedade</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="seguranca.js" defer></script>

    <style>
        :root {
            /* Paleta de Cores Premium */
            --primary: #5D5FEF; /* Azul índigo principal */
            --primary-soft: #8A8DFF;
            --secondary: #C3C4FF; /* Lilás claro */
            --accent: #FF7E67; /* Coral para destaque sutil */
            --text-dark: #2D3142;
            --text-med: #5A607F;
            --text-light: #9095A9;
            --white: #FFFFFF;
            
            /* Efeitos */
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: 1px solid rgba(255, 255, 255, 0.3);
            --shadow-soft: 0 8px 32px rgba(31, 38, 135, 0.07);
            --shadow-strong: 0 15px 40px -10px rgba(93, 95, 239, 0.3);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Poppins', sans-serif;
            /* Background Premium com Gradiente Suave */
            background: linear-gradient(135deg, #F6F8FD 0%, #EDF0FF 100%);
            color: var(--text-dark);
            height: 100vh; /* Garante tela cheia sem scroll */
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- HEADER (Vidromorfismo) --- */
        header {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: var(--glass-border);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            flex-shrink: 0;
        }

        .header-branding {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-logo {
            height: 38px;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(93, 95, 239, 0.2));
        }

        .header-title {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.3rem;
            letter-spacing: -0.5px;
            display: none;
        }
        @media(min-width: 768px) { .header-title { display: block; } }

        .btn-manual {
            background: rgba(93, 95, 239, 0.1);
            color: var(--primary);
            border: none;
            padding: 10px 18px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .btn-manual:hover { background: var(--primary); color: var(--white); }

        /* --- MAIN CONTENT AREA --- */
        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            gap: 30px;
            overflow-y: auto; /* Fallback para telas muito pequenas */
        }

        /* --- ROLETA REFLEXIVA --- */
        .roulette-wrapper {
            position: relative;
            width: 340px;
            height: 340px;
            max-width: 85vw;
            max-height: 85vw;
            /* Efeito de brilho atrás da roleta */
            background: radial-gradient(circle at center, rgba(93, 95, 239, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            padding: 10px;
        }

        .wheel-container {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid var(--white);
            box-shadow: var(--shadow-strong);
            position: relative;
            overflow: hidden;
            background: var(--white);
        }

        .wheel {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 50%;
            transition: transform 5s cubic-bezier(0.1, 0.7, 0.1, 1); /* Animação bem suave no final */
        }

        .segment {
            position: absolute;
            top: 0; left: 0;
            width: 50%; height: 50%;
            transform-origin: 100% 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Cores alternadas mais suaves */
        }
        .segment:nth-child(odd) { background: var(--primary); }
        .segment:nth-child(even) { background: var(--secondary); }

        .segment-icon {
            position: absolute;
            font-size: 1.6rem;
            color: var(--white);
            /* Posicionamento calculado para 8 segmentos */
            left: 50%; top: 15%;
            transform: translate(-50%, -50%) rotate(22.5deg); /* Ajuste fino do ângulo do ícone */
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
        }

        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5rem;
            color: var(--accent);
            z-index: 20;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.15));
        }

        .center-spin-btn {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 70px; height: 70px;
            background: var(--white);
            border-radius: 50%;
            z-index: 10;
            box-shadow: 0 0 15px rgba(93, 95, 239, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 1.8rem;
            cursor: pointer;
            border: 3px solid var(--secondary);
            transition: all 0.3s ease;
        }
        .center-spin-btn:active { transform: translate(-50%, -50%) scale(0.95); }

        /* --- ÁREA DE RESULTADO/AÇÃO --- */
        .action-area {
            width: 100%;
            max-width: 450px;
            min-height: 180px; /* Espaço reservado para evitar pulos */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Card de Reflexão (Substitui o botão) */
        .reflection-card {
            background: var(--white);
            padding: 25px;
            border-radius: 24px;
            box-shadow: var(--shadow-soft);
            width: 95%;
            display: none; /* Hidden initial state */
            animation: fadeSlideUp 0.6s ease forwards;
            text-align: center;
            border: var(--glass-border);
            position: relative;
            overflow: hidden;
        }

        .reflection-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 6px; height: 100%;
            background: var(--primary);
        }

        .reflection-title {
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .reflection-text {
            color: var(--text-med);
            font-size: 1rem;
            line-height: 1.6;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .btn-main-action {
            background: linear-gradient(135deg, var(--primary), var(--primary-soft));
            color: var(--white);
            border: none;
            padding: 16px 32px;
            font-size: 1.1rem;
            border-radius: 50px;
            box-shadow: 0 8px 20px -5px rgba(93, 95, 239, 0.5);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            width: auto;
            max-width: 90%;
        }
        .btn-main-action:hover { transform: translateY(-2px); box-shadow: 0 12px 25px -5px rgba(93, 95, 239, 0.6); }
        .btn-main-action:disabled { opacity: 0.7; cursor: wait; transform: none; }

        .btn-reset {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--primary);
            padding: 10px 24px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .btn-reset:hover { background: var(--secondary); color: var(--white); }

        /* --- RODAPÉ (Arrumado) --- */
        footer {
            background: var(--white);
            padding: 20px 25px;
            border-top: 1px solid rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column; /* Mobile first: coluna */
            gap: 20px;
            align-items: center;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-light);
            flex-shrink: 0;
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .footer-logo-img {
            height: 30px;
            margin-bottom: 8px;
            opacity: 0.8;
        }

        .footer-link { color: var(--primary); text-decoration: none; font-weight: 600; }
        
        .copyright-info {
            font-size: 0.7rem;
            margin-top: 5px;
            opacity: 0.8;
        }

        .btn-whatsapp {
            background: #25D366;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
            transition: transform 0.2s;
            width: 100%; /* Botão largo no mobile */
            justify-content: center;
            max-width: 300px;
        }
        .btn-whatsapp:hover { transform: translateY(-2px); }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(45, 49, 66, 0.6); /* Overlay mais escuro premium */
            backdrop-filter: blur(8px);
            display: none;
            align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-box {
            background: var(--white);
            padding: 30px;
            border-radius: 24px;
            width: 90%; max-width: 500px;
            position: relative;
            box-shadow: var(--shadow-strong);
        }
        .modal-close-btn {
            position: absolute; top: 15px; right: 20px;
            font-size: 1.8rem; color: var(--text-light); cursor: pointer;
        }

        /* Keyframes & Media Queries */
        @keyframes fadeSlideUp {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* Tablet e Desktop */
        @media(min-width: 768px) {
            main {
                flex-direction: row; /* Lado a lado */
                gap: 60px;
                justify-content: center;
            }
            .action-area { align-items: flex-start; text-align: left; }
            .reflection-card { text-align: left; }
            .reflection-title { justify-content: flex-start; }
            .roulette-wrapper { width: 420px; height: 420px; }
            
            footer {
                flex-direction: row; /* Rodapé em linha no desktop */
                justify-content: space-between;
                text-align: left;
                padding: 15px 40px;
            }
            .footer-content { align-items: flex-start; }
            .btn-whatsapp { width: auto; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-branding">
            <img src="https://gabrielopsicologo.com/wp-content/uploads/2025/12/Design-sem-nome.png" alt="Logo PsicoQuest" class="header-logo">
            <span class="header-title">PsicoQuest</span>
        </div>
        <button class="btn-manual" onclick="toggleModal('manualModal')">
            <i class="fas fa-book-reader"></i> <span style="display:none; @media(min-width:350px){display:inline;}">Manual Terapêutico</span>
        </button>
    </header>

    <main>
        <div class="roulette-wrapper">
            <i class="fas fa-map-marker-alt pointer"></i>
            
            <div class="wheel-container">
                <div class="wheel" id="wheel">
                    </div>
            </div>
            
            <div class="center-spin-btn" onclick="spinWheel()">
                <i class="fas fa-sync-alt"></i>
            </div>
        </div>

        <div class="action-area">
            <button id="mainSpinBtn" class="btn-main-action" onclick="spinWheel()">
                <i class="far fa-compass"></i> Buscar uma Reflexão
            </button>

            <div id="resultCard" class="reflection-card">
                <h3 class="reflection-title" id="cardTitle">
                    </h3>
                <p class="reflection-text" id="cardText">
                    </p>
                <button class="btn-reset" onclick="resetWheel()">
                    <i class="fas fa-redo"></i> Nova Perspectiva
                </button>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <img src="https://gabrielopsicologo.com/wp-content/uploads/2025/11/Logo_preta.png" alt="Logo Gabriel Psicólogo" class="footer-logo-img">
            <p><strong>Recurso terapêutico digital</strong></p>
            <p>Desenvolvido por <a href="https://www.instagram.com/gabrielopsicologo/#" target="_blank" class="footer-link">@gabrielopsicologo</a></p>
            <div class="copyright-info">
                CRP 06/215890 | © 2026 Todos os direitos reservados.
            </div>
        </div>
        
        <a href="https://wa.link/ydbdpl" target="_blank" class="btn-whatsapp">
            <i class="fab fa-whatsapp"></i> Suporte Técnico
        </a>
    </footer>

    <div id="manualModal" class="modal-overlay" onclick="closeModalOnOutside(event)">
        <div class="modal-box">
            <span class="modal-close-btn" onclick="toggleModal('manualModal')">&times;</span>
            <h3 style="color: var(--primary); margin-bottom: 15px; display:flex; align-items:center; gap:10px;">
                <i class="fas fa-book-open"></i> Manual do Terapeuta
            </h3>
            <p style="margin-bottom: 12px; font-weight: 600; color: var(--text-dark);">
                Bem-vindo à Roleta Reflexiva da Ansiedade.
            </p>
            <p style="font-size: 0.95rem; line-height: 1.7; color: var(--text-med);">
                Este recurso não busca "eliminar" a ansiedade com técnicas mecânicas, mas promover a <strong>flexibilidade cognitiva</strong> e a <strong>autobsrevação</strong>.
                <br><br>
                As reflexões são baseadas na TCC (Questionamento Socrático) e ACT (Desfusão e Aceitação). O objetivo é criar um espaço de pausa entre o gatilho ansioso e a reação automática.
                <br><br>
                <strong>Uso Clínico:</strong> Peça ao paciente para girar a roleta e, juntos, explorem a pergunta sorteada sem pressa para "resolver" o problema, mas para entendê-lo sob uma nova ótica.
            </p>
        </div>
    </div>

    <script>
        // --- DADOS REFLEXIVOS (8 ITENS - Base TCC/ACT) ---
        // Foco em questionamento, observação e perspectiva, não em "fazer algo".
        const reflections = [
            {
                id: 1,
                title: "Investigação Curiosa",
                text: "Se essa ansiedade tivesse uma voz, o que ela estaria tentando desesperadamente me alertar que é importante para mim?",
                icon: "fa-search-location"
            },
            {
                id: 2,
                title: "Perspectiva Externa",
                text: "Se a pessoa que eu mais amo no mundo estivesse sentindo exatamente isso agora, o que eu diria a ela com compaixão?",
                icon: "fa-user-friends"
            },
            {
                id: 3,
                title: "Verificação de Fatos",
                text: "Qual é a evidência real e concreta que eu tenho (não suposições) de que o pior cenário vai de fato acontecer?",
                icon: "fa-clipboard-check"
            },
            {
                id: 4,
                title: "Observação Somática",
                text: "Onde exatamente no meu corpo eu sinto essa emoção agora? Posso apenas notar essa sensação física sem tentar expulsá-la?",
                icon: "fa-hand-holding-heart"
            },
            {
                id: 5,
                title: "Desfusão do Pensamento",
                text: "Este pensamento catastrófico é uma verdade absoluta sobre o futuro ou apenas uma história assustadora que minha mente está contando?",
                icon: "fa-cloud-meatball"
            },
            {
                id: 6,
                title: "Círculo de Controle",
                text: "Nesta situação específica, o que está *realmente* sob meu controle direto e o que eu preciso praticar aceitar que não está?",
                icon: "fa-circle-notch"
            },
            {
                id: 7,
                title: "O Pior Cenário",
                text: "Mesmo que o pior aconteça, quais recursos internos ou externos eu já possuo que me ajudariam a lidar com isso e sobreviver?",
                icon: "fa-shield-alt"
            },
            {
                id: 8,
                title: "Tolerância à Incerteza",
                text: "Eu estou exigindo de mim mesmo uma certeza absoluta sobre o futuro que é impossível para qualquer ser humano ter?",
                icon: "fa-question"
            }
        ];

        // --- RENDERIZAÇÃO DA RODA (8 SEGMENTOS) ---
        const wheel = document.getElementById('wheel');
        const segmentCount = reflections.length; // 8
        const degPerSegment = 360 / segmentCount; // 45 graus

        reflections.forEach((item, index) => {
            const segment = document.createElement('div');
            segment.className = 'segment';
            
            // Cálculo matemático para 8 segmentos usando skew e rotate
            // Skew necessário = 90 - 45 = 45deg
            const rotate = index * degPerSegment;
            segment.style.transform = `rotate(${rotate}deg) skewY(-45deg)`;

            // Ícone
            const icon = document.createElement('i');
            // Classes do FontAwesome
            icon.className = `fas ${item.icon} segment-icon`;
            // Contrarotação para manter o ícone reto visualmente
            // SkewY(45deg) + Rotate(metade do segmento para centralizar = 22.5deg)
            icon.style.transform = `skewY(45deg) rotate(22.5deg) translate(90px)`; // Translate ajusta a distância do centro

            segment.appendChild(icon);
            wheel.appendChild(segment);
        });

        // --- LÓGICA DO GIRO (COM REFLEXÃO) ---
        let currentRotation = 0;
        let isSpinning = false;

        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;

            // UI States
            document.getElementById('resultCard').style.display = 'none';
            document.getElementById('mainSpinBtn').disabled = true;
            document.getElementById('mainSpinBtn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Buscando...';

            // Matemática do Giro
            const randomOffset = Math.floor(Math.random() * 360);
            // Adiciona muitas voltas (360 * 8) para uma animação longa e satisfatória
            const spinAmount = (360 * 8) + randomOffset; 
            currentRotation += spinAmount;
            
            // Aplica a rotação (Anti-horário para alinhar com o ponteiro superior)
            wheel.style.transform = `rotate(-${currentRotation}deg)`;

            // Tempo da animação (5s no CSS)
            setTimeout(() => {
                showReflection(currentRotation % 360);
                isSpinning = false;
                document.getElementById('mainSpinBtn').disabled = false;
                 // O botão principal some e dá lugar ao card
                document.getElementById('mainSpinBtn').style.display = 'none';
            }, 5000); // Sincronizado com os 5s do CSS transition
        }

        function showReflection(finalAngleNormalized) {
            // Lógica para encontrar o vencedor baseado no ângulo final
            // Como giramos anti-horário, o cálculo do índice inverte.
            const rawIndex = Math.floor(finalAngleNormalized / degPerSegment);
            
            // Ajuste fino do índice devido ao sistema de coordenadas do CSS
            // O segmento 0 começa na direita, o ponteiro está no topo (90deg offset anti-horário)
            // A lógica simplificada para 8 segmentos e ponteiro top:
            let winningIndex = (segmentCount - 1 - rawIndex + 2) % segmentCount; // +2 é um offset empírico para alinhar o ponteiro superior com este método de CSS

            const reflection = reflections[winningIndex];

            // Preenche o card reflexivo
            document.getElementById('cardTitle').innerHTML = `<i class="fas ${reflection.icon}"></i> ${reflection.title}`;
            document.getElementById('cardText').innerText = reflection.text;
            
            // Mostra o card com animação
            document.getElementById('resultCard').style.display = 'block';
        }

        function resetWheel() {
            document.getElementById('resultCard').style.display = 'none';
            const mainBtn = document.getElementById('mainSpinBtn');
            mainBtn.style.display = 'flex';
            mainBtn.innerHTML = '<i class="far fa-compass"></i> Buscar Outra Reflexão';
        }

        // --- LÓGICA DO MODAL ---
        function toggleModal(id) {
            const modal = document.getElementById(id);
            modal.style.display = (modal.style.display === 'flex') ? 'none' : 'flex';
        }
        function closeModalOnOutside(event) {
            if (event.target.className === 'modal-overlay') event.target.style.display = 'none';
        }
    </script>
</body>
</html>